# atlantis.yaml
version: 3
projects:
# If two or more projects have the same dir and workspace, they must also have
# a 'name' key to differentiate them.
- name: build-project
  dir: ./build-clusters
  workflow: build
- name: dev-project
  dir: ./workload-clusters
  workflow: dev
- name: prod-project
  dir: ./workload-clusters
  workflow: prod

workflows:
  build:
    plan:
      steps:
      - init:
          extra_args: ["-backend-config", "backend.tfvars"]
      - plan:
          extra_args: ["-var-file", "build.tfvars"]
  dev:
    plan:
      steps:
      - init:
          extra_args: ["-backend-config", "./env/dev/backend.tfvars"]
      - plan:
          extra_args: ["-var-file", "./env/dev/dev.tfvars"]

  prod:
    plan:
      steps:
      - init:
          extra_args: ["-backend-config", "./env/prod/backend.tfvars"]
      - plan:
          extra_args: ["-var-file", "./env/prod/prod.tfvars"]